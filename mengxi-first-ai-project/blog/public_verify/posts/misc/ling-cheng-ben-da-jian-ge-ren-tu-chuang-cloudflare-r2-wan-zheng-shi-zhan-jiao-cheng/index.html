<!doctype html><html lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠï¼šCloudflare R2å®Œæ•´å®æˆ˜æ•™ç¨‹ | Mengxi's Blog</title><meta name=description content="ğŸ‰ é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠï¼Cloudflare R2 å®Œæ•´å®æˆ˜æ•™ç¨‹ é€‚åˆäººç¾¤ï¼šåšä¸»ã€å¼€å‘è€…ã€å…¬ä¼—å·è¿è¥è€… å…³é”®è¯ï¼šå…è´¹å›¾åºŠ | Cloudflare R2 | æ°¸ä¹…å­˜å‚¨ | å…¨çƒ CDN
ğŸ’¡ ä¸ºä»€ä¹ˆé€‰æ‹© Cloudflare R2ï¼Ÿ ä¼ ç»Ÿå›¾åºŠçš„ç—›ç‚¹ï¼š
âŒ å…è´¹é¢åº¦ç”¨å®Œå°±æ”¶è´¹ âŒ è®¿é—®é€Ÿåº¦æ…¢ï¼Œç»å¸¸å¤±æ•ˆ âŒ æœ‰æ°´å°æˆ–å¹¿å‘Š âŒ â€¦"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&amp;family=Noto+Sans+SC:wght@300;400;500;600;700&amp;family=Fira+Code:wght@400;500&amp;family=Patrick+Hand&amp;display=swap" rel=stylesheet><link rel=icon type=image/png sizes=32x32 href=/%20images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/%20images/favicon-16x16.png><link rel=stylesheet href=/%20css/unified-styles.css><link rel=stylesheet href=/%20css/image-zoom.css><style>body{opacity:0;animation:fadeInPage .5s ease-out forwards}@keyframes fadeInPage{from{opacity:0}to{opacity:1}}</style></head><body class=theme-knowledge><div class=hn-header id=top-nav><div class=hn-header-content><a href=/ style=text-decoration:none><span class=hn-logo>M</span>
</a><span class=hn-title><a href=/>Mengxi News</a></span><nav class=hn-nav><a href=/posts>new</a> |
<a href=/graph>graph</a> |
<a href=/timeline>timeline</a> |
<a href=/search>search</a></nav></div></div><main class="u-container u-py-xl"><header class="u-text-center u-mb-xl"><h1>é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠï¼šCloudflare R2å®Œæ•´å®æˆ˜æ•™ç¨‹</h1><div class="u-flex u-justify-center u-gap-md u-text-light"><span>Jan 6, 2026</span>
<span>â€¢</span>
<span>7 min read</span></div></header><article class=prose style="max-width:800px;margin:0 auto"><div class=post-content><h1 id=-é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠcloudflare-r2-å®Œæ•´å®æˆ˜æ•™ç¨‹>ğŸ‰ é›¶æˆæœ¬æ­å»ºä¸ªäººå›¾åºŠï¼Cloudflare R2 å®Œæ•´å®æˆ˜æ•™ç¨‹</h1><blockquote><p>é€‚åˆäººç¾¤ï¼šåšä¸»ã€å¼€å‘è€…ã€å…¬ä¼—å·è¿è¥è€…
å…³é”®è¯ï¼šå…è´¹å›¾åºŠ | Cloudflare R2 | æ°¸ä¹…å­˜å‚¨ | å…¨çƒ CDN</p></blockquote><hr><p><img src=https://xixi-image-bed.jinxiyue07.workers.dev/1764908366629-no52e.png alt=image style="width:100%;max-width:360px;height:auto;display:block;margin:10px auto" class=u-img-responsive loading=lazy></p><h2 id=-ä¸ºä»€ä¹ˆé€‰æ‹©-cloudflare-r2>ğŸ’¡ ä¸ºä»€ä¹ˆé€‰æ‹© Cloudflare R2ï¼Ÿ</h2><p>ä¼ ç»Ÿå›¾åºŠçš„ç—›ç‚¹ï¼š</p><ul><li>âŒ å…è´¹é¢åº¦ç”¨å®Œå°±æ”¶è´¹</li><li>âŒ è®¿é—®é€Ÿåº¦æ…¢ï¼Œç»å¸¸å¤±æ•ˆ</li><li>âŒ æœ‰æ°´å°æˆ–å¹¿å‘Š</li><li>âŒ éšç§å®‰å…¨æ— ä¿éšœ</li></ul><p><strong>Cloudflare R2 çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… <strong>10GB æ°¸ä¹…å…è´¹å­˜å‚¨</strong></li><li>âœ… <strong>é€šè¿‡ Workers è®¿é—®é›¶æµé‡è´¹</strong></li><li>âœ… <strong>å…¨çƒ CDN åŠ é€Ÿï¼Œè®¿é—®é£å¿«</strong></li><li>âœ… <strong>å®Œå…¨æŒæ§ï¼Œæ•°æ®å®‰å…¨</strong></li><li>âœ… <strong>æ— é™æ¬¡ä¸Šä¼ /ä¸‹è½½ï¼ˆå…è´¹é¢åº¦å†…ï¼‰</strong></li></ul><hr><h2 id=-æ­å»ºæ­¥éª¤5æ­¥å®Œæˆ>ğŸš€ æ­å»ºæ­¥éª¤ï¼ˆ5æ­¥å®Œæˆï¼‰</h2><h3 id=ç¬¬ä¸€æ­¥æ³¨å†Œ-cloudflare-è´¦å·><strong>ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œ Cloudflare è´¦å·</strong></h3><ol><li>è®¿é—® <a href=https://dash.cloudflare.com/sign-up>Cloudflare Dashboard</a></li><li>æ³¨å†Œå¹¶éªŒè¯é‚®ç®±</li><li>ç™»å½•åˆ°æ§åˆ¶å°</li></ol><blockquote><p>ğŸ’¡ æç¤ºï¼šæ— éœ€ä¿¡ç”¨å¡ï¼Œå®Œå…¨å…è´¹</p></blockquote><hr><h3 id=ç¬¬äºŒæ­¥åˆ›å»º-r2-å­˜å‚¨æ¡¶><strong>ç¬¬äºŒæ­¥ï¼šåˆ›å»º R2 å­˜å‚¨æ¡¶</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. å·¦ä¾§èœå•é€‰æ‹©ã€ŒR2ã€
</span></span><span class=line><span class=cl>2. ç‚¹å‡»ã€ŒCreate bucketã€
</span></span><span class=line><span class=cl>3. è¾“å…¥å­˜å‚¨æ¡¶åç§°ï¼ˆå¦‚ï¼šmy-image-bedï¼‰
</span></span><span class=line><span class=cl>4. é€‰æ‹©åŒºåŸŸï¼šAsia Pacificï¼ˆäºšå¤ªï¼‰
</span></span><span class=line><span class=cl>5. ç‚¹å‡»ã€ŒCreate bucketã€
</span></span></code></pre></td></tr></table></div></div><p>âœ… å­˜å‚¨æ¡¶åˆ›å»ºæˆåŠŸï¼</p><hr><h3 id=ç¬¬ä¸‰æ­¥åˆ›å»º-worker><strong>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º Worker</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=mf>1.</span> <span class=err>å·¦ä¾§èœå•é€‰æ‹©ã€Œ</span><span class=n>Workers</span> <span class=err>å’Œ</span> <span class=n>Pages</span><span class=err>ã€</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>ç‚¹å‡»ã€Œåˆ›å»ºåº”ç”¨ç¨‹åºã€</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=err>é€‰æ‹©ã€Œåˆ›å»º</span> <span class=n>Worker</span><span class=err>ã€</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=err>è¾“å…¥åç§°ï¼ˆå¦‚ï¼š</span><span class=n>image</span><span class=o>-</span><span class=n>upload</span><span class=err>ï¼‰</span>
</span></span><span class=line><span class=cl><span class=mf>5.</span> <span class=err>ç‚¹å‡»ã€Œéƒ¨ç½²ã€</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=ç¬¬å››æ­¥ç¼–è¾‘-worker-ä»£ç ><strong>ç¬¬å››æ­¥ï¼šç¼–è¾‘ Worker ä»£ç </strong></h3><p>éƒ¨ç½²åç‚¹å‡»ã€Œç¼–è¾‘ä»£ç ã€ï¼Œåˆ é™¤é»˜è®¤ä»£ç ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span> <span class=nx>env</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>corsHeaders</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Access-Control-Allow-Origin&#39;</span><span class=o>:</span> <span class=s1>&#39;*&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Access-Control-Allow-Methods&#39;</span><span class=o>:</span> <span class=s1>&#39;GET, POST, OPTIONS&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Access-Control-Allow-Headers&#39;</span><span class=o>:</span> <span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>method</span> <span class=o>===</span> <span class=s1>&#39;OPTIONS&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=p>{</span> <span class=nx>headers</span><span class=o>:</span> <span class=nx>corsHeaders</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// æ£€æŸ¥ R2 ç»‘å®š
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>env</span><span class=p>.</span><span class=nx>MY_BUCKET</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;R2 bucket not configured&#39;</span>
</span></span><span class=line><span class=cl>      <span class=p>}),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>status</span><span class=o>:</span> <span class=mi>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=p>...</span><span class=nx>corsHeaders</span><span class=p>,</span> <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// ä¸Šä¼ æ¥å£
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>method</span> <span class=o>===</span> <span class=s1>&#39;POST&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span> <span class=o>===</span> <span class=s1>&#39;/upload&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>formData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>request</span><span class=p>.</span><span class=nx>formData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>file</span> <span class=o>=</span> <span class=nx>formData</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;file&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>file</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶&#39;</span>
</span></span><span class=line><span class=cl>          <span class=p>}),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=o>:</span> <span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=p>...</span><span class=nx>corsHeaders</span><span class=p>,</span> <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// ç”Ÿæˆæ–‡ä»¶å
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>timestamp</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>randomStr</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=mi>36</span><span class=p>).</span><span class=nx>substring</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>extension</span> <span class=o>=</span> <span class=nx>file</span><span class=p>.</span><span class=nx>name</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>).</span><span class=nx>pop</span><span class=p>()</span> <span class=o>||</span> <span class=s1>&#39;jpg&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>fileName</span> <span class=o>=</span> <span class=sb>`</span><span class=si>${</span><span class=nx>timestamp</span><span class=si>}</span><span class=sb>-</span><span class=si>${</span><span class=nx>randomStr</span><span class=si>}</span><span class=sb>.</span><span class=si>${</span><span class=nx>extension</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// ä¸Šä¼ åˆ° R2
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>await</span> <span class=nx>env</span><span class=p>.</span><span class=nx>MY_BUCKET</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>fileName</span><span class=p>,</span> <span class=nx>file</span><span class=p>.</span><span class=nx>stream</span><span class=p>(),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>httpMetadata</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>contentType</span><span class=o>:</span> <span class=nx>file</span><span class=p>.</span><span class=nx>type</span> <span class=o>||</span> <span class=s1>&#39;image/jpeg&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>imageUrl</span> <span class=o>=</span> <span class=sb>`</span><span class=si>${</span><span class=nx>url</span><span class=p>.</span><span class=nx>origin</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>fileName</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>url</span><span class=o>:</span> <span class=nx>imageUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>filename</span><span class=o>:</span> <span class=nx>fileName</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=p>...</span><span class=nx>corsHeaders</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>error</span><span class=o>:</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>status</span><span class=o>:</span> <span class=mi>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=p>...</span><span class=nx>corsHeaders</span><span class=p>,</span> <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è·å–å›¾ç‰‡
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>method</span> <span class=o>===</span> <span class=s1>&#39;GET&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>key</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;å›¾åºŠ API è¿è¡Œä¸­ âœ…&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>headers</span><span class=o>:</span> <span class=nx>corsHeaders</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>object</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>env</span><span class=p>.</span><span class=nx>MY_BUCKET</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>object</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;Image not found&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>status</span><span class=o>:</span> <span class=mi>404</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>headers</span><span class=o>:</span> <span class=nx>corsHeaders</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>headers</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Headers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>object</span><span class=p>.</span><span class=nx>writeHttpMetadata</span><span class=p>(</span><span class=nx>headers</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s1>&#39;Cache-Control&#39;</span><span class=p>,</span> <span class=s1>&#39;public, max-age=31536000&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>corsHeaders</span><span class=p>).</span><span class=nx>forEach</span><span class=p>(([</span><span class=nx>k</span><span class=p>,</span> <span class=nx>v</span><span class=p>])</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>headers</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>k</span><span class=p>,</span> <span class=nx>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>object</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=p>{</span> <span class=nx>headers</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;Method not allowed&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>status</span><span class=o>:</span> <span class=mi>405</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=nx>corsHeaders</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>ç‚¹å‡»ã€Œä¿å­˜å¹¶éƒ¨ç½²ã€</p><hr><h3 id=ç¬¬äº”æ­¥ç»‘å®š-r2-å­˜å‚¨æ¡¶><strong>ç¬¬äº”æ­¥ï¼šç»‘å®š R2 å­˜å‚¨æ¡¶</strong></h3><p>è¿™æ˜¯<strong>æœ€å…³é”®</strong>çš„ä¸€æ­¥ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. åœ¨ Worker é¡µé¢ï¼Œç‚¹å‡»ã€Œè®¾ç½®ã€â†’ã€Œç»‘å®šã€
</span></span><span class=line><span class=cl>2. ç‚¹å‡»ã€Œæ·»åŠ ç»‘å®šã€
</span></span><span class=line><span class=cl>3. å¡«å†™ï¼š
</span></span><span class=line><span class=cl>   - ç»‘å®šç±»å‹ï¼šR2 bucket
</span></span><span class=line><span class=cl>   - å˜é‡åç§°ï¼šMY_BUCKETï¼ˆå¿…é¡»å®Œå…¨ä¸€è‡´ï¼ï¼‰
</span></span><span class=line><span class=cl>   - R2 å­˜å‚¨æ¡¶ï¼šé€‰æ‹©ä½ åˆ›å»ºçš„å­˜å‚¨æ¡¶
</span></span><span class=line><span class=cl>4. ç‚¹å‡»ã€Œä¿å­˜ã€
</span></span><span class=line><span class=cl>5. é‡æ–°éƒ¨ç½² Worker
</span></span></code></pre></td></tr></table></div></div><p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šå˜é‡åå¿…é¡»æ˜¯ <code>MY_BUCKET</code>ï¼Œä¸ä»£ç ä¸­çš„ <code>env.MY_BUCKET</code> å¯¹åº”ï¼</p><hr><h2 id=-åˆ›å»ºä¸Šä¼ é¡µé¢>ğŸ¨ åˆ›å»ºä¸Šä¼ é¡µé¢</h2><p>åˆ›å»ºä¸€ä¸ª <code>upload.html</code> æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;zh-CN&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>å›¾åºŠä¸Šä¼ <span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>font-family</span><span class=p>:</span> <span class=o>-</span><span class=n>apple-system</span><span class=p>,</span> <span class=kc>sans-serif</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=nb>linear-gradient</span><span class=p>(</span><span class=mi>135</span><span class=kt>deg</span><span class=p>,</span> <span class=mh>#667eea</span> <span class=mi>0</span><span class=kt>%</span><span class=p>,</span> <span class=mh>#764ba2</span> <span class=mi>100</span><span class=kt>%</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>min-height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>vh</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>container</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>max-width</span><span class=p>:</span> <span class=mi>800</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>40</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>box-shadow</span><span class=p>:</span> <span class=mi>0</span> <span class=mi>20</span><span class=kt>px</span> <span class=mi>60</span><span class=kt>px</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mf>0.3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nt>h1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>text-align</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=mh>#333</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>#</span><span class=nn>drop-zone</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>border</span><span class=p>:</span> <span class=mi>3</span><span class=kt>px</span> <span class=kc>dashed</span> <span class=mh>#ddd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>15</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>60</span><span class=kt>px</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>text-align</span><span class=p>:</span> <span class=kc>center</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>cursor</span><span class=p>:</span> <span class=kc>pointer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>transition</span><span class=p>:</span> <span class=kc>all</span> <span class=mf>0.3</span><span class=kt>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>#</span><span class=nn>drop-zone</span><span class=p>:</span><span class=nd>hover</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>border-color</span><span class=p>:</span> <span class=mh>#667eea</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=mh>#f0f4ff</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>drop-icon</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>font-size</span><span class=p>:</span> <span class=mi>64</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin-bottom</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>#</span><span class=nn>result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>margin-top</span><span class=p>:</span> <span class=mi>30</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=mh>#f8f9fa</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>display</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>url-input</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=mh>#ddd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>font-family</span><span class=p>:</span> <span class=kc>monospace</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nc>copy-btn</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>padding</span><span class=p>:</span> <span class=mi>8</span><span class=kt>px</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>background</span><span class=p>:</span> <span class=mh>#667eea</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>color</span><span class=p>:</span> <span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>cursor</span><span class=p>:</span> <span class=kc>pointer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>#</span><span class=nn>preview</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>max-width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>margin-top</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>ğŸ“¸ å›¾åºŠä¸Šä¼ <span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;drop-zone&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;drop-icon&#34;</span><span class=p>&gt;</span>ğŸ“¤<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œä¸Šä¼ <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;file&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;file-input&#34;</span> <span class=na>accept</span><span class=o>=</span><span class=s>&#34;image/*&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;display:none&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;result&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>h3</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;color: #28a745;&#34;</span><span class=p>&gt;</span>âœ… ä¸Šä¼ æˆåŠŸï¼<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span><span class=p>&gt;&lt;</span><span class=nt>strong</span><span class=p>&gt;</span>å›¾ç‰‡é“¾æ¥ï¼š<span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;image-url&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;url-input&#34;</span> <span class=na>readonly</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>button</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;copy-btn&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;copyUrl()&#34;</span><span class=p>&gt;</span>å¤åˆ¶é“¾æ¥<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;display: block; margin-top: 15px;&#34;</span><span class=p>&gt;&lt;</span><span class=nt>strong</span><span class=p>&gt;</span>Markdownï¼š<span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;markdown-url&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;url-input&#34;</span> <span class=na>readonly</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>button</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;copy-btn&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;copyMarkdown()&#34;</span><span class=p>&gt;</span>å¤åˆ¶ Markdown<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>img</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;preview&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;é¢„è§ˆ&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æ›¿æ¢ä¸ºä½ çš„ Worker åœ°å€
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>UPLOAD_API</span> <span class=o>=</span> <span class=s1>&#39;https://your-worker.workers.dev/upload&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>dropZone</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;drop-zone&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>fileInput</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;file-input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;result&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>imageUrl</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;image-url&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>markdownUrl</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;markdown-url&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>preview</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;preview&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>dropZone</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=nx>fileInput</span><span class=p>.</span><span class=nx>click</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>dropZone</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;dragover&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>dropZone</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>borderColor</span> <span class=o>=</span> <span class=s1>&#39;#667eea&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>dropZone</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;drop&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>files</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>dataTransfer</span><span class=p>.</span><span class=nx>files</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>files</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=nx>uploadFile</span><span class=p>(</span><span class=nx>files</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>fileInput</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;change&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>files</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=nx>uploadFile</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>files</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>async</span> <span class=kd>function</span> <span class=nx>uploadFile</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>formData</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>formData</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;file&#39;</span><span class=p>,</span> <span class=nx>file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>dropZone</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;div class=&#34;drop-icon&#34;&gt;â³&lt;/div&gt;&lt;div&gt;ä¸Šä¼ ä¸­...&lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>UPLOAD_API</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>body</span><span class=o>:</span> <span class=nx>formData</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>success</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>imageUrl</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>markdownUrl</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=sb>`![image](</span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>url</span><span class=si>}</span><span class=sb>)`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>preview</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>result</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s1>&#39;block&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>dropZone</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;div class=&#34;drop-icon&#34;&gt;âœ…&lt;/div&gt;&lt;div&gt;ä¸Šä¼ æˆåŠŸï¼ç»§ç»­ä¸Šä¼ ï¼Ÿ&lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;ä¸Šä¼ å¤±è´¥ï¼š&#39;</span> <span class=o>+</span> <span class=nx>data</span><span class=p>.</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>dropZone</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;div class=&#34;drop-icon&#34;&gt;ğŸ“¤&lt;/div&gt;&lt;div&gt;ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œä¸Šä¼ &lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;ä¸Šä¼ å¤±è´¥ï¼š&#39;</span> <span class=o>+</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>dropZone</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;div class=&#34;drop-icon&#34;&gt;ğŸ“¤&lt;/div&gt;&lt;div&gt;ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œä¸Šä¼ &lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>copyUrl</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>imageUrl</span><span class=p>.</span><span class=nx>select</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;copy&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;âœ… é“¾æ¥å·²å¤åˆ¶ï¼&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>copyMarkdown</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>markdownUrl</span><span class=p>.</span><span class=nx>select</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;copy&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;âœ… Markdown å·²å¤åˆ¶ï¼&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>âš ï¸ è®°å¾—ä¿®æ”¹ <code>UPLOAD_API</code> ä¸ºä½ çš„ Worker åœ°å€ï¼</p><hr><h2 id=-æµ‹è¯•éªŒè¯>ğŸ§ª æµ‹è¯•éªŒè¯</h2><h3 id=1-æµ‹è¯•-worker-æ˜¯å¦è¿è¡Œ><strong>1. æµ‹è¯• Worker æ˜¯å¦è¿è¡Œ</strong></h3><p>è®¿é—®ï¼š<code>https://your-worker.workers.dev</code>
åº”è¯¥çœ‹åˆ°ï¼š<code>å›¾åºŠ API è¿è¡Œä¸­ âœ…</code></p><h3 id=2-æµ‹è¯•ä¸Šä¼ åŠŸèƒ½><strong>2. æµ‹è¯•ä¸Šä¼ åŠŸèƒ½</strong></h3><ul><li>ç”¨æµè§ˆå™¨æ‰“å¼€ <code>upload.html</code></li><li>æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</li><li>æˆåŠŸåä¼šæ˜¾ç¤ºå›¾ç‰‡ URL å’Œ Markdown æ ¼å¼</li></ul><h3 id=3-æµ‹è¯•å›¾ç‰‡è®¿é—®><strong>3. æµ‹è¯•å›¾ç‰‡è®¿é—®</strong></h3><p>å¤åˆ¶ä¸Šä¼ åçš„ URLï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œåº”è¯¥èƒ½çœ‹åˆ°å›¾ç‰‡</p><hr><h2 id=-å¸¸è§é—®é¢˜æ’æŸ¥>ğŸ”¥ å¸¸è§é—®é¢˜æ’æŸ¥</h2><h3 id=é—®é¢˜1500-é”™è¯¯><strong>é—®é¢˜1ï¼š500 é”™è¯¯</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>é”™è¯¯ï¼šInternal server error: R2 bucket not configured
</span></span></code></pre></td></tr></table></div></div><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>æ£€æŸ¥ Worker çš„ã€Œç»‘å®šã€æ ‡ç­¾é¡µ</li><li>ç¡®è®¤å˜é‡åæ˜¯ <code>MY_BUCKET</code>ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</li><li>ç¡®è®¤å·²é€‰æ‹©æ­£ç¡®çš„ R2 å­˜å‚¨æ¡¶</li><li>é‡æ–°éƒ¨ç½² Worker</li></ul><h3 id=é—®é¢˜2ä¸Šä¼ å¤±è´¥><strong>é—®é¢˜2ï¼šä¸Šä¼ å¤±è´¥</strong></h3><p><strong>æ£€æŸ¥æ¸…å•ï¼š</strong></p><ul><li><input disabled type=checkbox> Worker ä»£ç æ˜¯å¦æ­£ç¡®éƒ¨ç½²</li><li><input disabled type=checkbox> R2 ç»‘å®šæ˜¯å¦é…ç½®</li><li><input disabled type=checkbox> ä¸Šä¼ é¡µé¢çš„ API åœ°å€æ˜¯å¦æ­£ç¡®</li><li><input disabled type=checkbox> æŸ¥çœ‹ Worker æ—¥å¿—ï¼ˆDashboard â†’ Worker â†’ æ—¥å¿—ï¼‰</li></ul><h3 id=é—®é¢˜3å›¾ç‰‡æ— æ³•è®¿é—®><strong>é—®é¢˜3ï¼šå›¾ç‰‡æ— æ³•è®¿é—®</strong></h3><p><strong>å¯èƒ½åŸå› ï¼š</strong></p><ul><li>Worker è·¯ç”±é…ç½®é—®é¢˜</li><li>R2 å­˜å‚¨æ¡¶æƒé™é—®é¢˜</li><li>æ–‡ä»¶åæˆ–è·¯å¾„é”™è¯¯</li></ul><hr><h2 id=-è¿›é˜¶ä¼˜åŒ–>ğŸ¯ è¿›é˜¶ä¼˜åŒ–</h2><h3 id=1-ç»‘å®šè‡ªå®šä¹‰åŸŸå><strong>1. ç»‘å®šè‡ªå®šä¹‰åŸŸå</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Worker è®¾ç½® â†’ è§¦å‘å™¨ â†’ è‡ªå®šä¹‰åŸŸ
</span></span><span class=line><span class=cl>æ·»åŠ ï¼šimg.yourdomain.com
</span></span></code></pre></td></tr></table></div></div><h3 id=2-æ·»åŠ æ–‡ä»¶å¤§å°é™åˆ¶><strong>2. æ·»åŠ æ–‡ä»¶å¤§å°é™åˆ¶</strong></h3><p>åœ¨ä»£ç ä¸­æ·»åŠ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nx>size</span> <span class=o>&gt;</span> <span class=mi>5</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;æ–‡ä»¶ä¸èƒ½è¶…è¿‡ 5MB&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>400</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-é™åˆ¶æ–‡ä»¶ç±»å‹><strong>3. é™åˆ¶æ–‡ä»¶ç±»å‹</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>allowedTypes</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;image/jpeg&#39;</span><span class=p>,</span> <span class=s1>&#39;image/png&#39;</span><span class=p>,</span> <span class=s1>&#39;image/gif&#39;</span><span class=p>,</span> <span class=s1>&#39;image/webp&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>allowedTypes</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>file</span><span class=p>.</span><span class=nx>type</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;åªå…è®¸ä¸Šä¼ å›¾ç‰‡&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}),</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>400</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-æˆæœ¬åˆ†æ>ğŸ“Š æˆæœ¬åˆ†æ</h2><table><thead><tr><th style=text-align:left>é¡¹ç›®</th><th style=text-align:left>å…è´¹é¢åº¦</th><th style=text-align:left>è¶…å‡ºè´¹ç”¨</th></tr></thead><tbody><tr><td style=text-align:left><strong>å­˜å‚¨ç©ºé—´</strong></td><td style=text-align:left>10 GB</td><td style=text-align:left>$0.015/GB/æœˆ</td></tr><tr><td style=text-align:left><strong>A ç±»æ“ä½œ</strong>ï¼ˆä¸Šä¼ ï¼‰</td><td style=text-align:left>100ä¸‡æ¬¡/æœˆ</td><td style=text-align:left>$4.50/ç™¾ä¸‡æ¬¡</td></tr><tr><td style=text-align:left><strong>B ç±»æ“ä½œ</strong>ï¼ˆä¸‹è½½ï¼‰</td><td style=text-align:left>1000ä¸‡æ¬¡/æœˆ</td><td style=text-align:left>$0.36/ç™¾ä¸‡æ¬¡</td></tr><tr><td style=text-align:left><strong>Worker è¯·æ±‚</strong></td><td style=text-align:left>10ä¸‡æ¬¡/å¤©</td><td style=text-align:left>å…è´¹</td></tr></tbody></table><p>ğŸ’¡ <strong>ç»“è®º</strong>ï¼šä¸ªäººä½¿ç”¨åŸºæœ¬ä¸ä¼šè¶…å‡ºå…è´¹é¢åº¦ï¼</p><hr><h2 id=-æœ€ç»ˆæ•ˆæœ>âœ¨ æœ€ç»ˆæ•ˆæœ</h2><ul><li>âœ… ä¸Šä¼ é€Ÿåº¦å¿«ï¼Œè®¿é—®ç¨³å®š</li><li>âœ… æ”¯æŒæ‹–æ‹½ä¸Šä¼ ã€è‡ªåŠ¨ç”Ÿæˆ Markdown</li><li>âœ… å…¨çƒ CDN åŠ é€Ÿï¼Œè®¿é—®é£å¿«</li><li>âœ… å®Œç¾é€‚é… Obsidianã€Notionã€å…¬ä¼—å·ç­‰</li></ul><hr><h2 id=-å†™åœ¨æœ€å>ğŸ’¬ å†™åœ¨æœ€å</h2><p>Cloudflare R2 å›¾åºŠé€‚åˆï¼š</p><ul><li>ğŸ“ åšä¸»ï¼šå†™ä½œé…å›¾</li><li>ğŸ‘¨â€ğŸ’» å¼€å‘è€…ï¼šé¡¹ç›®æ–‡æ¡£</li><li>ğŸ“± å…¬ä¼—å·è¿è¥ï¼šæ–‡ç« æ’å›¾</li><li>ğŸ“ å­¦ç”Ÿï¼šç¬”è®°ç®¡ç†</li></ul><p><strong>é›¶æˆæœ¬ã€ç¨³å®šå¯é ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒå›¾ç‰‡å¤±æ•ˆæˆ–é™é€Ÿäº†ï¼</strong></p><hr><p><strong>è§‰å¾—æœ‰ç”¨ï¼Ÿç‚¹èµ+åœ¨çœ‹ï¼Œè®©æ›´å¤šäººçœ‹åˆ°ï¼</strong> ğŸŒŸ</p><p>æˆ‘æ˜¯çº¯çº¯å°ç™½å°æºªï¼ä¹‹å‰æŠ˜è…¾å…¬ä¼—å·é…å›¾+å‘æ–‡ç« ï¼ŒåŠå¤©æ—¶é—´è€—åœ¨ã€Œæ‰¾å›¾åºŠâ†’ä¼ å›¾â†’è°ƒæ ¼å¼ã€çš„æ­»</p><p>å¾ªç¯é‡Œâ€¦</p><p>ç›´åˆ°é‡åˆ°Claude Codeï¼å®ƒåƒä¸ªè€å¿ƒçš„æŠ€æœ¯æ­å­âœ¨ï¼š</p><ul><li><p>æ‰‹æŠŠæ‰‹æ•™æˆ‘é…ç½®Cloudflare R2å›¾åºŠï¼Œä¸€æ­¥é”™éƒ½ä¸è¡Œçš„é‚£ç§ï¼</p></li><li><p>è¿˜èƒ½è‡ªåŠ¨ç”ŸæˆObsidianç¬”è®°å­˜æ•™ç¨‹ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹æŠ„æ­¥éª¤ï½</p></li><li><p>å›¾åºŠæå®šåç›´æ¥ä¸€é”®å‘å…¬ä¼—å·ï¼Œæ•ˆç‡ä»ã€ŒåŠå¤©ç†¬ç§ƒå¤´ã€ç¼©åˆ°ã€Œ1å°æ—¶æå®šæ‘¸é±¼å»ã€ï¼</p></li></ul><p>åŸæ¥ç”¨å¯¹å·¥å…·ï¼Œã€Œéº»çƒ¦çš„å°äº‹ã€çœŸçš„èƒ½å˜ã€Œä¸€é”®å¿«ä¹ã€ï¼</p><p>æ¯•ç«Ÿå•Šâ€”â€”è¿™ä¸ªæ—¶ä»£ï¼ŒæŠŠæ—¶é—´çœä¸‹æ¥æ‘¸é±¼ã€å†¥æƒ³ã€å…»ç”Ÿã€å°‘èŠ±é’±å¤šæ”’é’±ï¼Œæ‰æ˜¯çœŸæ­£çš„ã€Œç”Ÿå‘½æ„ä¹‰ã€</p><p>ï½</p></div></article></main><footer class="u-container u-py-xl u-text-center"><div class=u-mb-md><span class=u-text-2xl>ğŸŒ±</span></div><p class=u-text-light>Â© 2026 Mengxi's Blog. Cultivated with intention.</p></footer><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        document.querySelectorAll('pre code.language-mermaid').forEach(el => {
            const pre = el.parentElement;
            const div = document.createElement('div');
            div.className = 'mermaid';
            div.textContent = el.textContent;
            pre.replaceWith(div);
        });
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            securityLevel: 'loose',
            themeVariables: {
                fontFamily: '"Patrick Hand", cursive',
                fontSize: '18px',
                primaryColor: '#fffef0',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#2c3e50',
                lineColor: '#2c3e50',
                secondaryColor: '#f1c40f',
                tertiaryColor: '#fff'
            }
        });
    </script><script src=/%20js/copy-code.js></script><script src=/%20js/hn-interactions.js></script><script src=/%20js/image-zoom.js></script><script src=/%20js/ux-booster.js></script></body></html>