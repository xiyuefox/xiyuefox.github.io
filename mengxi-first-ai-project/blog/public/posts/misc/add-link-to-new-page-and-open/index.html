<!DOCTYPE html>
<html lang="zh-cn">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Link to New Page and Open | Mengxi&#39;s Blog</title>


<link href="https://fonts.googleapis.com" rel="preconnect" />
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
<link
    href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />


<link rel="stylesheet" href="/css/unified-styles.css">
</head>

<body class="theme-knowledge">
    <nav class="u-nav">
    <div class="u-container u-nav__container">
        <a href="http://localhost:1313/" class="u-nav__brand">
            <span class="u-nav__logo-emoji">ðŸŒ¿</span> Mengxi&#39;s Blog
        </a>
        <ul class="u-nav__links">
            
            <li><a href="/" class="u-nav__link ">Home</a></li>
            
            <li><a href="/posts" class="u-nav__link ">Posts</a></li>
            
            <li><a href="/search" class="u-nav__link ">Search</a></li>
            
            <li><a href="/timeline/" class="u-nav__link ">Timeline</a></li>
            
            <li><a href="/guide/" class="u-nav__link ">Guide</a></li>
            
            <li><a href="/upload/" class="u-nav__link ">Upload</a></li>
            
        </ul>
    </div>
</nav>

    <main class="u-container u-py-xl">
        
<header class="u-text-center u-mb-xl">
    <h1>Add Link to New Page and Open</h1>
    <div class="u-flex u-justify-center u-gap-md u-text-light">
        <span>Dec 15, 2025</span>
        <span>â€¢</span>
        <span>2 min read</span>
    </div>
</header>

<article class="u-card" style="max-width: 800px; margin: 0 auto;">
    <div class="content">
        <p>/*</p>
<p>Prompts for filename. Offers option to create and open a new Markdown or Excalidraw document. Adds link pointing to the new file, to the selected objects in the drawing. You can control in settings to open the file in the current active pane or an adjacent pane.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">verifyMinimumPluginVersion</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">verifyMinimumPluginVersion</span>(<span style="color:#e6db74">&#34;1.6.1&#34;</span>)) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Notice</span>(<span style="color:#e6db74">&#34;This script requires a newer version of Excalidraw. Please install the latest version.&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">settings</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getScriptSettings</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">settings</span>[<span style="color:#e6db74">&#34;Open link in active pane&#34;</span>]) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">settings</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Open link in active pane&#34;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Open the link in the current active pane (on) or a new pane (off).&#34;</span>
</span></span><span style="display:flex;"><span>	},
</span></span><span style="display:flex;"><span>    ...<span style="color:#a6e22e">settings</span>
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">setScriptSettings</span>(<span style="color:#a6e22e">settings</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">openInCurrentPane</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">settings</span>[<span style="color:#e6db74">&#34;Open link in active pane&#34;</span>].<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">elements</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getViewSelectedElements</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Notice</span>(<span style="color:#e6db74">&#34;No selected elements&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">activeFile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">targetView</span>.<span style="color:#a6e22e">file</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">activeFile</span>.<span style="color:#a6e22e">basename</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">timestamp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">moment</span>(Date.<span style="color:#a6e22e">now</span>()).<span style="color:#a6e22e">format</span>(<span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">plugin</span>.<span style="color:#a6e22e">settings</span>.<span style="color:#a6e22e">drawingFilenameDateTime</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">fileType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">filename</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">inputPrompt</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Filename for new document&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">prefix</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> - </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">timestamp</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span>  [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">caption</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Markdown&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">action</span><span style="color:#f92672">:</span> ()=&gt;{<span style="color:#a6e22e">fileType</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;md&#34;</span>;<span style="color:#66d9ef">return</span>;}
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">caption</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Excalidraw&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">action</span><span style="color:#f92672">:</span> ()=&gt;{<span style="color:#a6e22e">fileType</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ex&#34;</span>;<span style="color:#66d9ef">return</span>;}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">filename</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">filename</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">filepath</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">activeFile</span>.<span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">activeFile</span>.<span style="color:#a6e22e">name</span>,<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">filename</span><span style="color:#e6db74">}</span><span style="color:#e6db74">.md`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">fileManager</span>.<span style="color:#a6e22e">createNewMarkdownFileFromLinktext</span>(<span style="color:#a6e22e">filepath</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">file</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">fileType</span><span style="color:#f92672">===</span><span style="color:#e6db74">&#34;ex&#34;</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">blank</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">plugins</span>.<span style="color:#a6e22e">plugins</span>[<span style="color:#e6db74">&#34;obsidian-excalidraw-plugin&#34;</span>].<span style="color:#a6e22e">getBlankDrawing</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">vault</span>.<span style="color:#a6e22e">modify</span>(<span style="color:#a6e22e">file</span>,<span style="color:#a6e22e">blank</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">new</span> Promise(<span style="color:#a6e22e">r</span> =&gt; <span style="color:#a6e22e">setTimeout</span>(<span style="color:#a6e22e">r</span>, <span style="color:#ae81ff">100</span>)); <span style="color:#75715e">//wait for metadata cache to update, so file opens as excalidraw
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">link</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`[[</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">metadataCache</span>.<span style="color:#a6e22e">fileToLinktext</span>(<span style="color:#a6e22e">file</span>,<span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">targetView</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">path</span>,<span style="color:#66d9ef">true</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">]]`</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">backgroundColor</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;transparent&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">strokeColor</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rgba(70,130,180,0.05)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">strokeWidth</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">roughness</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">length</span><span style="color:#f92672">===</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">elements</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">type</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;text&#34;</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">copyViewElementsToEAforEditing</span>(<span style="color:#a6e22e">elements</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getElements</span>()[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">link</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">link</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">b</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getBoundingBox</span>(<span style="color:#a6e22e">elements</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">addEllipse</span>(<span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">topX</span><span style="color:#f92672">+</span><span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">width</span><span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">topY</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getElement</span>(<span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">link</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">link</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">copyViewElementsToEAforEditing</span>(<span style="color:#a6e22e">elements</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">addToGroup</span>(<span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">e</span>)=&gt;<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">id</span>).<span style="color:#a6e22e">concat</span>([<span style="color:#a6e22e">id</span>]));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">await</span> <span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">addElementsToView</span>(<span style="color:#66d9ef">false</span>,<span style="color:#66d9ef">true</span>,<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">selectElementsInView</span>(<span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">getElements</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">openInCurrentPane</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">workspace</span>.<span style="color:#a6e22e">openLinkText</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">path</span>,<span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">targetView</span>.<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">path</span>,<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ea</span>.<span style="color:#a6e22e">openFileInNewOrAdjacentLeaf</span>(<span style="color:#a6e22e">file</span>);
</span></span></code></pre></div>
    </div>
</article>

    </main>

    <footer class="u-container u-py-xl u-text-center">
    <div class="u-mb-md">
        <span class="u-text-2xl">ðŸŒ±</span>
    </div>
    <p class="u-text-light">
        Â© 2025 Mengxi&#39;s Blog. Cultivated with intention.
    </p>
</footer>
</body>

</html>